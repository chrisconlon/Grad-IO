\def\beamerclassoptions{[xcolor=pdftex,dvipsnames,table,mathserif,aspectratio=169]}
\input{../resources/preamble.tex}
\usetheme{metropolis}

%\usetheme{Darmstadt}
%\usepackage{times}
%\usefonttheme{structurebold}

\usepackage[english]{babel}
%\usepackage[table]{xcolor}
\usepackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps}
\usepackage{amsmath,amssymb,setspace,centernot}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{relsize}
\usepackage{stmaryrd}
\usepackage{pdfpages}
\usepackage{booktabs}
\usepackage[absolute,overlay]{textpos} 


\newenvironment{reference}[2]{% 
  \begin{textblock*}{\textwidth}(#1,#2) 
      \footnotesize\it\bgroup\color{red!50!black}}{\egroup\end{textblock*}} 

\DeclareMathSizes{10}{10}{6}{6} 
\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}
\begin{document}
\title{Mergers and Counterfactual Prices}
\author{Chris Conlon}
\institute{Grad IO}
\date{\today}

\frame{\titlepage}

\begin{frame}
\frametitle{Merger Simulation: Two Options}
 \begin{itemize}
\item Partial Merger Simulation
 \begin{itemize}
\item Simulate a new price for $p_j$ after acquiring good $k$ holding the prices of all other goods $(p_k,p_{-j})$ fixed.
\item Repeat for $p_k$ and all other products involved in the merger.
\item Compare price increases to \alert{synergies} or cost savings.
 \end{itemize}
 \item Full Merger Simulation
 \begin{itemize}
\item Write down the full system of post-merger FOC.
\item Adjust post-merger marginal costs for potential synergies.
\item Solve for all prices at the new (post-merger) equilibrium $(p_j,p_k,p_{-j})$.
 \end{itemize}
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Differentiated Products Bertrand}
\small
Recall the multi-product Bertrand FOCs:
\begin{align*}
\arg \max_{p \in \calJ_f} \pi_f (\symbf{p}) &= \sum_{j \in \calJ_f} (p_j - c_j) \cdot q_j(\symbf{p}) \\
\rightarrow 0&= q_j(\symbf{p}) + \sum_{k \in \calJ_f} (p_k - c_k) \frac{\partial q_{k}}{\partial p_j}(\symbf{p})
\end{align*}
It is helpful to define the matrix $\Delta$ with entries:
\begin{align*}
\Delta_{(j,k)}(\symbf{p}) = \left\{\begin{array}{lr}
         - \frac{\partial q_{j}}{\partial p_k}(\symbf{p}) & \text{for }  (j,k) \in \calJ_f\\
       	  \quad 0 & \text{for } (j,k) \notin \calJ_f
        \end{array} \right\}
\end{align*}
We can re-write the FOC in matrix form:
\begin{align*}
q(\symbf{p}) = \Delta(\symbf{p})\cdot(\symbf{p}-\symbf{mc})
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Merger Simulation}
What does a merger do? \alert{change the ownership matrix}.
\begin{itemize}

\item Step 1: Recover marginal costs $\widehat{\symbf{mc}} = \symbf{p} +\Delta(\symbf{p})^{-1}q(\symbf{p})$.
\item Step 1a: (Possibly) adjust marginal cost $\widehat{\symbf{mc}}\cdot (1-e)$ with some cost efficiency $e$.
\item Step 2: Change the ownership matrix $\Delta^{pre}(\symbf{p}) \rightarrow \Delta^{post}(\symbf{p})$.
\item Step 3: Solve for $\symbf{p}^{post}$ via: $\symbf{p} = \widehat{\symbf{mc}} - \Delta(\symbf{p})^{-1}q(\symbf{p})$.
\end{itemize}
\pause
\vspace{0.5cm}
\begin{itemize}
\item The first step is easy (just a matrix inverse).
\item The second step is trivial.
\item The third step is tricky because we have to solve an implicit system of equations. $\symbf{p}$ is on both sides.
\end{itemize}
\end{frame}


\begin{frame}{Partial Merger Analysis}
\begin{itemize}
\item Hold all other prices $p_{-j}$ fixed at \alert{pre-merger} prices.
\item Adjust the marginal costs for potential efficiencies.
\item Consider only the FOC for product $j$
\begin{eqnarray*}
0&=& q_j(\symbf{p}) + \sum_{k \in \calJ_f} (p_k - c_k) \frac{\partial q_{k}}{\partial p_j}(\symbf{p})
\end{eqnarray*}
\item Solve for the new $p_j$ given the change in the products controlled by firm $f$: $\calJ_f \rightarrow \calJ_f'$
\item This is a single Gauss-Jacobi step (only products involved in merger).
\end{itemize}
\end{frame} 

\begin{frame}{Partial Merger Analysis: Why bother?}
\begin{itemize}
\item We only need own and cross elasticities for products involved in the merger.
\item Tends to show smaller price increases than full equilibrium merger analysis.
\item Only solving a single equation rather than a system of $J$ nonlinear equations.
\end{itemize}
\end{frame} 



\begin{frame}{Solution Methods}
How do we solve: $\symbf{p} = \widehat{\symbf{mc}} - \Delta(\symbf{p})^{-1}q(\symbf{p})$?
\begin{enumerate}
\item Gauss Jacobi: Simultaneous Best Reply  $p_j^{k+1}(\symbf{p_{-j}^k})$.
\item Gauss Seidel: Iterated Best Response  $p_j^{k+1}(\symbf{p_{<j}^{k+1}},\symbf{p_{>j}^{k}})$.
\item Newton's Method: Set $\symbf{p} - \widehat{\symbf{mc}} + \Delta(\symbf{p})^{-1}q(\symbf{p})=0$\\ but requires derivatives of $\Delta(\symbf{p})^{-1}q(\symbf{p})$
\item Fixed point iteration: $\symbf{p} \mapsfrom \widehat{\symbf{mc}} - \Delta(\symbf{p})^{-1}q(\symbf{p})$
\begin{itemize}
\item Turns out this is \alert{not a contraction}.
\item But you can get lucky... $\symbf{p} - \widehat{\symbf{mc}} + \Delta(\symbf{p})^{-1}q(\symbf{p})=0$ means you have satisfied FOC's
\end{itemize}
\item Alternative fixed point.
\end{enumerate}
\end{frame} 

\begin{frame}{Exploit the logit formula}
For the logit the $\Delta$ matrix (for a single market) looks like:
\begin{align*}
\Delta_{(j,k)}(\symbf{p}) = \left\{\begin{array}{lr}
       \int \alpha_i \cdot s_{ij}\cdot (1-s_{ij}) \, \partial F_i& \text{ if } j=k \\
       	  \quad -\int \alpha_i \cdot s_{ij} \cdot s_{ik} \, \partial F_i &  \text{ if }  j\neq k 
        \end{array} \right\}
\end{align*}
Which we can factor into two parts (for plain logit):
\begin{align*}
\Delta(\symbf{p}) =  \underbrace{\text{ Diag}\left[ \alpha \, \symbf{s}(\symbf{p}) \, \right]}_{\Lambda(\symbf{p})} -  \underbrace{\alpha \cdot \symbf{s}(\symbf{p}) \symbf{s}(\symbf{p})'}_{\Gamma(\symbf{p})}
\end{align*}
$\Gamma(\symbf{p})$ and $\Lambda(\symbf{p})$ are $J \times J$ matrices and $\Lambda(\symbf{p})$ is diagonal and $(j,k)$ is nonzero in $\Gamma(\symbf{p})$ only if $(j,k)$ share an owner.
\end{frame}


\begin{frame}{Morrow Skerlos (2010) Fixed Point}
\begin{itemize}
\item After factoring we can rescale by $\Lambda^{-1} (\symbf{p})$
\begin{align*}
(\symbf{p}-\symbf{mc} ) \mapsfrom \Lambda^{-1}(\symbf{p}) \cdot \Gamma(\symbf{p})\cdot(\symbf{p}- \symbf{mc}) - \Lambda^{-1}(\symbf{p})\cdot s(\symbf{p})
\end{align*}
\item This alternative fixed point is in fact a contraction.
\item Moreover the rate of convergence is generally fast and stable (much more than Gauss-Seidel or Gauss-Jacobi).
\item Honestly, this is the best way to solve large pricing games. It nearly always wins and doesn't require derivatives.
\item Coincidentally, this is what \texttt{PyBLP} defaults to.
\end{itemize}
\end{frame}



\begin{frame}{Other Counterfactuals}
Lots of cases where we want to recompute prices:
\begin{itemize}
\item Change conduct/ownership $\mathcal{H}_t(\kappa)$.
\item Change the $mc$ (add a tax, tariff, etc.)
\item Add/drop a product/products from the choice set $\calJ_t$.
\item Change demographics of consumers $d_i$
\end{itemize}
\end{frame}










\end{document}